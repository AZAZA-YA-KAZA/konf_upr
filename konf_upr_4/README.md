# Задание 4 - Разработка ассемблера и интерпретатора для учебной виртуальной машины (УВМ)
## Вариант №9
## Постановка задачи
Для ассемблера необходимо разработать читаемое представление команд УВМ. Ассемблер принимает на вход файл с текстом исходной программы, путь к которой задается из командной строки.

Результатом работы ассемблера является бинарный файл в виде последовательности байт, путь к которому задается из командной строки.

Дополнительный ключ командной строки задает путь к файлу-логу, в котором хранятся ассемблированные инструкции в духе списков 
“ключ=значение”, как в приведенных далее тестах.

Интерпретатор принимает на вход бинарный файл, выполняет команды УВМ и сохраняет в файле-результате значения из диапазона памяти УВМ. Диапазон также указывается из командной строки.

Форматом для файла-лога и файла-результата является csv.

Необходимо реализовать приведенные тесты для всех команд, а также написать и отладить тестовую программу.

## Загрузка константы
| A | B | C |
|---|---|---|
| Биты 0—6 | Биты 7-10 | Биты 11-30 |
| 99 | Адрес | Константа |

Размер команды: 4 байт. Операнд: поле C. Результат: регистр по адресу, которым является поле B.

Тест (A=99, B=5, C=606): 0xС6, 0xA0, 0x04, 0x5E

## Чтение значения из памяти
| A | B | C |
|---|---|---|
|Биты 0—6 | Биты 7—10 | Биты 11—30|
| 96 | Адрес | Адрес|

Размер команды: 4 байт. Операнд: значение в памяти по адресу, которым является поле C. Результат: регистр по адресу, которым является поле B.

Тест (A=96, B=11, C=622): 0xC1, 0x60, 0x02, 0x6E

## Запись значения в память
| A | B | C |
|---|---|---|
| Биты 0—6 | Биты 7—26 | Биты 27—30|
|1 | Адрес | Адрес |

Размер команды: 4 байт. Операнд: регистр по адресу, которым является поле C. Результат: значение в памяти по адресу, которым является поле B.

Тест (A=1, B=744, C=11): 0x02, 0x00, 0x5D, 0x0B

## Унарная операция: bswap()
| A | B | C |
|---|---|---|
| Биты 0—6 | Биты 7—10 | Биты 11—14 |
| 82 | Адрес | Адрес |

Размер команды: 2 байт. Операнд: регистр по адресу, которым является поле B. Результат: регистр по адресу, которым является поле C.

Тест (A=82, B=3, C=9): 0x72, 0xA4

## Тестовая программа
Выполнить поэлементно операцию bswap() над вектором длины 4. Результат записать в исходный вектор.
## 1. Запуск
Для автоматической сборки запустите файл bash.sh
Перед запуском необходимо клонировать репозиторий в среду разработки
```
git clone https://github.com/AZAZA-YA-KAZA/konf_upr/tree/master/konf_upr_4
```
## Необходимые библиотеки и их установка
```Bash
pip install pytest
```
библиотека для тестов
# Переход в директорию
```shell
cd konf_upr_4
```
# Запуск программы
```shell
python assembler.py program.txt output.bin log.csv
python interpretator.py output.bin result.csv 0-600
```
# Тестирование
```shell
pytest test.py
```
# Программный файл
Пример файла:
```
LOAD_CONST 5 606
LOAD_MEM 11 622
STORE_MEM 5 2
BSWAP 3 9
```
## 2. Функции настройки:
1. def assemble_command(instruction, operands): Функция сборки команды
2. def assembler(arg): Ассемблер
3. def test_bswap(): Программа для выполнения BSWAP над вектором длины 4
4. def execute_command(command, memory): Функция для выполнения команды
5. def interpreter(input_file, memory_range, output_file): Интерпретатор
## 3. Тестирование
![image](https://github.com/user-attachments/assets/daa40bbe-9e54-45c0-87e9-627712f6d59d)
# Примеры работы
### 1.  python assembler.py program.txt output.bin log.csv
![image](https://github.com/user-attachments/assets/94e8a797-21b6-4036-a00f-25f07d0dbed9)
### 2. python interpretator.py output.bin result.csv 0-600
![image](https://github.com/user-attachments/assets/613a7754-b24c-4159-8098-16bb647e3fbb)
